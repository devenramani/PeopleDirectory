{"version":3,"sources":["webparts/peopleDirectory/components/PeopleList/PeopleList.tsx"],"names":[],"mappings":"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","file":"webparts/peopleDirectory/components/PeopleList/PeopleList.js","sourcesContent":["import * as React from 'react';\r\nimport { IPeopleListProps } from '.';\r\nimport {\r\n  Persona,\r\n  PersonaSize\r\n} from 'office-ui-fabric-react/lib/Persona';\r\nimport * as strings from 'PeopleDirectoryWebPartStrings';\r\nimport styles from './PeopleList.module.scss';\r\nimport { Callout, DirectionalHint } from 'office-ui-fabric-react/lib/Callout';\r\nimport { IPeopleListState } from './IPeopleListState';\r\nimport { PeopleCallout } from '../PeopleCallout';\r\n\r\nimport { HoverCard, IExpandingCardProps } from 'office-ui-fabric-react/lib/HoverCard';\r\nimport { Fabric } from 'office-ui-fabric-react/lib/Fabric';\r\n\r\nimport { Panel, PanelType } from 'office-ui-fabric-react/lib/Panel';\r\nimport { mergeStyleSets } from 'office-ui-fabric-react/lib/Styling';\r\n\r\nimport { DefaultButton } from 'office-ui-fabric-react/lib/Button';\r\n\r\n\r\nconst classNames = mergeStyleSets({\r\n  compactCard: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    height: '100%'\r\n  },\r\n  expandedCard: {\r\n    padding: '16px 24px'\r\n  },\r\n  item: {\r\n    selectors: {\r\n      '&:hover': {\r\n        textDecoration: 'underline',\r\n        cursor: 'pointer'\r\n      }\r\n    }\r\n  }\r\n});\r\n\r\n\r\nexport class PeopleList extends React.Component<IPeopleListProps, IPeopleListState> {\r\n  constructor(props: IPeopleListProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      showCallOut: false,\r\n      calloutElement: null,\r\n      person: null,\r\n      showPanel: false\r\n\r\n    };\r\n\r\n    //this._onPersonaClicked = this._onPersonaClicked.bind(this);\r\n    this._onCalloutDismiss = this._onCalloutDismiss.bind(this);\r\n  }\r\n\r\n  public render(): React.ReactElement<IPeopleListProps> {\r\n    return (\r\n      <div className={`ms-Grid ms-Grid-row`}>\r\n        {this.props.people.length === 0 &&\r\n          (this.props.selectedIndex !== 'Search' ||\r\n            (this.props.selectedIndex === 'Search' &&\r\n              this.props.hasSearchQuery)) &&\r\n          // Show the 'No people found' message if no people have been retrieved\r\n          // and the user either selected a letter in the navigation or issued\r\n          // a search query (but not when navigated to the Search tab without\r\n          // providing a query yet)\r\n          <div className='ms-textAlignCenter'>{strings.NoPeopleFoundLabel}</div>}\r\n        {this.props.people.length > 0 &&\r\n          // for each retrieved person, create a persona card with the retrieved\r\n          // information\r\n          //this.props.people.map(p => <Persona primaryText={p.name} secondaryText={p.email} tertiaryText={p.phone} imageUrl={p.photoUrl} imageAlt={p.name} size={PersonaSize.size72} />)\r\n\r\n          this.props.people.map((p, i) => {\r\n            const phone: string = p.phone && p.mobile ? `${p.phone}/${p.mobile}` : p.phone ? p.phone : p.mobile;\r\n            // const toggleClassName: string = this.state.toggleClass ? `ms-Icon--ChromeClose ${styles.isClose}` : \"ms-Icon--ContactInfo\";\r\n            if (!p.photoUrl) {\r\n              p.photoUrl = \"https://m365x109001-my.sharepoint.com/User%20Photos/Profile%20Pictures/admin_m365x109001_onmicrosoft_com_MThumb.jpg\";\r\n            }\r\n\r\n            const expandingCardProps: IExpandingCardProps = {\r\n              onRenderCompactCard: this._onRenderCompactCard,\r\n              onRenderExpandedCard: this._onRenderExpandedCard,\r\n              renderData: p\r\n            };\r\n\r\n\r\n            return (\r\n              <div className={`ms-Grid-col  ${styles.persona_card}`}>\r\n                {/* <Persona primaryText={p.name} secondaryText={p.email} tertiaryText={phone} imageUrl={p.photoUrl} imageAlt={p.name} size={PersonaSize.size48} />\r\n                  <div id={`callout${i}`} onClick={this._onPersonaClicked(i, p)} className={styles.persona}>\r\n                    <i className=\"ms-Icon ms-Icon--ContactInfo\" aria-hidden=\"true\"></i>\r\n                  </div> */}\r\n                {/* <HoverCard expandingCardProps={expandingCardProps} instantOpenOnClick={true}>\r\n                  <div className={styles.card}>\r\n                    <img src={p.photoUrl} className={styles.profile_image} />\r\n                    <div className={styles.container}>\r\n                      <h4><b>{p.name}</b></h4>\r\n                    </div>\r\n                  </div>\r\n                </HoverCard> */}\r\n\r\n                <div className={styles.card}>\r\n                  <img src={p.photoUrl} className={styles.profile_image} />\r\n                  <div className={styles.container}>\r\n                    <h4><b>{p.name}</b></h4>\r\n\r\n                    <div id={`callout${i}`} onClick={this._onPersonaClicked(i, p)} className={styles.persona}>\r\n                      <i className=\"ms-Icon ms-Icon--ContactInfo\" aria-hidden=\"true\"></i>\r\n                    </div>\r\n\r\n                  </div>\r\n                </div>\r\n\r\n                {this.state.showCallOut && this.state.calloutElement === i && (\r\n                  <Callout\r\n                    className={this.state.showCallOut ? styles.calloutShow : styles.callout}\r\n                    gapSpace={16}\r\n                    target={`#callout${i}`}\r\n                    isBeakVisible={true}\r\n                    beakWidth={18}\r\n                    setInitialFocus={true}\r\n                    onDismiss={this._onCalloutDismiss}\r\n                    directionalHint={DirectionalHint.rightCenter}\r\n                    doNotLayer={false}\r\n                  >\r\n                    <PeopleCallout person={this.state.person}></PeopleCallout>\r\n                  </Callout>\r\n                )}\r\n                \r\n                <Panel isOpen={this.state.showPanel} isLightDismiss={true} headerText=\"Light Dismiss Panel\" onDismiss={this._hidePanel}>\r\n                  <span>Light Dismiss usage is meant for the Contextual Menu on mobile sized breakpoints.</span>\r\n                </Panel>\r\n              </div>\r\n\r\n            );\r\n          })\r\n\r\n        }\r\n      </div>\r\n\r\n    );\r\n  }\r\n\r\n  private _showPanel = (): void => {\r\n    this.setState({ showPanel: true });\r\n  };\r\n\r\n  private _hidePanel = (): void => {\r\n    this.setState({ showPanel: false });\r\n  };\r\n\r\n  private _onRenderCompactCard = (p): JSX.Element => {\r\n    return (\r\n      <div className={classNames.compactCard}>\r\n        <a target=\"_blank\" href={``}>\r\n          {p.name}\r\n        </a>\r\n\r\n      </div>\r\n    );\r\n  };\r\n\r\n  private _onRenderExpandedCard = (p): JSX.Element => {\r\n    return (\r\n      <div className={classNames.expandedCard}>\r\n        {p.department}\r\n        {p.function}\r\n        {p.skills}\r\n        {p.projects}\r\n        <DefaultButton text=\"Open panel\" onClick={this._showPanel} />\r\n      </div>\r\n    );\r\n  };\r\n\r\n\r\n  private _onPersonaClicked = (index, person) => event => {\r\n    this.setState({\r\n      showCallOut: !this.state.showCallOut,\r\n      calloutElement: index,\r\n      person: person\r\n    });\r\n  }\r\n\r\n  private _onCalloutDismiss = (event) => {\r\n    this.setState({\r\n      showCallOut: false,\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\..\\..\\src"}