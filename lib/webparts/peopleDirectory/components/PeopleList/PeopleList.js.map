{"version":3,"sources":["webparts/peopleDirectory/components/PeopleList/PeopleList.tsx"],"names":[],"mappings":"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","file":"webparts/peopleDirectory/components/PeopleList/PeopleList.js","sourcesContent":["import * as React from 'react';\r\nimport { IPeopleListProps } from '.';\r\nimport {\r\n  Persona,\r\n  PersonaSize\r\n} from 'office-ui-fabric-react/lib/Persona';\r\nimport * as strings from 'PeopleDirectoryWebPartStrings';\r\nimport styles from './PeopleList.module.scss';\r\nimport { Callout, DirectionalHint } from 'office-ui-fabric-react/lib/Callout';\r\nimport { IPeopleListState } from './IPeopleListState';\r\nimport { PeopleCallout } from '../PeopleCallout';\r\n\r\nimport { HoverCard, IExpandingCardProps } from 'office-ui-fabric-react/lib/HoverCard';\r\nimport { Fabric } from 'office-ui-fabric-react/lib/Fabric';\r\n\r\nimport { Panel, PanelType } from 'office-ui-fabric-react/lib/Panel';\r\nimport { mergeStyleSets } from 'office-ui-fabric-react/lib/Styling';\r\n\r\nimport { DefaultButton } from 'office-ui-fabric-react/lib/Button';\r\n\r\nexport class PeopleList extends React.Component<IPeopleListProps, IPeopleListState> {\r\n  constructor(props: IPeopleListProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      showCallOut: false,\r\n      calloutElement: null,\r\n      person: null,\r\n      showPanel: false\r\n    };\r\n\r\n    //this._onPersonaClicked = this._onPersonaClicked.bind(this);\r\n    this._onCalloutDismiss = this._onCalloutDismiss.bind(this);\r\n  }\r\n\r\n  public render(): React.ReactElement<IPeopleListProps> {\r\n    return (\r\n      <div className={`ms-Grid ms-Grid-row`}>\r\n        {this.props.people.length === 0 &&\r\n          (this.props.selectedIndex !== 'Search' ||\r\n            (this.props.selectedIndex === 'Search' &&\r\n              this.props.hasSearchQuery)) &&\r\n          // Show the 'No people found' message if no people have been retrieved\r\n          // and the user either selected a letter in the navigation or issued\r\n          // a search query (but not when navigated to the Search tab without\r\n          // providing a query yet)\r\n          <div className='ms-textAlignCenter'>{strings.NoPeopleFoundLabel}</div>}\r\n        {this.props.people.length > 0 &&\r\n          // for each retrieved person, create a persona card with the retrieved\r\n          // information\r\n          //this.props.people.map(p => <Persona primaryText={p.name} secondaryText={p.email} tertiaryText={p.phone} imageUrl={p.photoUrl} imageAlt={p.name} size={PersonaSize.size72} />)\r\n\r\n          this.props.people.map((p, i) => {\r\n            const phone: string = p.phone && p.mobile ? `${p.phone}/${p.mobile}` : p.phone ? p.phone : p.mobile;\r\n            // const toggleClassName: string = this.state.toggleClass ? `ms-Icon--ChromeClose ${styles.isClose}` : \"ms-Icon--ContactInfo\";\r\n            if (!p.photoUrl) {\r\n              p.photoUrl = \"/_layouts/15/userphoto.aspx?size=L&accountname\";\r\n            }\r\n\r\n            const expandingCardProps: IExpandingCardProps = {\r\n              onRenderCompactCard: this._onRenderCompactCard,\r\n              onRenderExpandedCard: this._onRenderExpandedCard,\r\n              renderData: p\r\n            };\r\n\r\n\r\n            return (\r\n              <div className={`ms-Grid-col  ${styles.persona_card}`}>\r\n                {/* <Persona primaryText={p.name} secondaryText={p.email} tertiaryText={phone} imageUrl={p.photoUrl} imageAlt={p.name} size={PersonaSize.size48} />\r\n                  <div id={`callout${i}`} onClick={this._onPersonaClicked(i, p)} className={styles.persona}>\r\n                    <i className=\"ms-Icon ms-Icon--ContactInfo\" aria-hidden=\"true\"></i>\r\n                  </div> */}\r\n                <HoverCard expandingCardProps={expandingCardProps} instantOpenOnClick={true}>\r\n                  <div className={styles.card}>\r\n                    <img src={p.photoUrl} className={styles.profile_image} />\r\n                    <div className={styles.container}>\r\n                      <h4><b>{p.name}</b></h4>\r\n                    </div>\r\n                  </div>\r\n                </HoverCard>\r\n                \r\n                <Panel isOpen={this.state.showPanel} type={PanelType.medium} headerText=\"Panel\" onDismiss={this._hidePanel}>\r\n                  <span>Test</span>\r\n                </Panel>\r\n              </div>\r\n            );\r\n          })\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _showPanel = (): void => {\r\n    this.setState({ showPanel: true });\r\n  };\r\n\r\n  private _hidePanel = (): void => {\r\n    this.setState({ showPanel: false });\r\n  };\r\n\r\n  private _onRenderCompactCard = (p): JSX.Element => {\r\n    return (\r\n      \r\n      <div className={styles.compactCard}>\r\n          <h2>{p.name}</h2>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  private _onRenderExpandedCard = (p): JSX.Element => {\r\n    return (\r\n      <div className={styles.expandedCard}>\r\n        {p.department}\r\n        {p.function}\r\n        {p.skills}\r\n        {p.projects}\r\n        <DefaultButton text=\"Open panel\" onClick={this._showPanel} />\r\n      </div>\r\n    );\r\n  };\r\n\r\n\r\n  private _onPersonaClicked = (index, person) => event => {\r\n    this.setState({\r\n      showCallOut: !this.state.showCallOut,\r\n      calloutElement: index,\r\n      person: person\r\n    });\r\n  }\r\n\r\n  private _onCalloutDismiss = (event) => {\r\n    this.setState({\r\n      showCallOut: false,\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\..\\..\\src"}